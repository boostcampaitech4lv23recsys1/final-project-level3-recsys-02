[2023-02-04 18:40:52,047] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Train.Train scheduled__2023-02-01T00:00:00+00:00 [queued]>
[2023-02-04 18:40:52,053] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Train.Train scheduled__2023-02-01T00:00:00+00:00 [queued]>
[2023-02-04 18:40:52,053] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2023-02-04 18:40:52,053] {taskinstance.py:1242} INFO - Starting attempt 1 of 1
[2023-02-04 18:40:52,053] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2023-02-04 18:40:52,063] {taskinstance.py:1262} INFO - Executing <Task(BashOperator): Train> on 2023-02-01 00:00:00+00:00
[2023-02-04 18:40:52,065] {standard_task_runner.py:52} INFO - Started process 66300 to run task
[2023-02-04 18:40:52,068] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'Train', 'Train', 'scheduled__2023-02-01T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', '/opt/ml/git/final-project-level3-recsys-02/Airflow/dags/RecSys_02.py', '--cfg-path', '/tmp/tmpvglrrhe0', '--error-file', '/tmp/tmph4pkl2xd']
[2023-02-04 18:40:52,068] {standard_task_runner.py:77} INFO - Job 10: Subtask Train
[2023-02-04 18:40:52,090] {logging_mixin.py:109} INFO - Running <TaskInstance: Train.Train scheduled__2023-02-01T00:00:00+00:00 [running]> on host 3ab801c1e2ef
[2023-02-04 18:40:52,113] {taskinstance.py:1412} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=RecSys-02
AIRFLOW_CTX_DAG_ID=Train
AIRFLOW_CTX_TASK_ID=Train
AIRFLOW_CTX_EXECUTION_DATE=2023-02-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-02-01T00:00:00+00:00
[2023-02-04 18:40:52,114] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2023-02-04 18:40:52,114] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'python /opt/ml/git/final-project-level3-recsys-02/bentoml/run_finetune_full.py']
[2023-02-04 18:40:52,120] {subprocess.py:85} INFO - Output:
[2023-02-04 18:40:54,053] {subprocess.py:89} INFO - output/ created
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO - Traceback (most recent call last):
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -   File "/opt/ml/git/final-project-level3-recsys-02/bentoml/run_finetune_full.py", line 187, in <module>
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -     main()
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -   File "/opt/ml/git/final-project-level3-recsys-02/bentoml/run_finetune_full.py", line 98, in main
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -     user_seq, max_item, valid_rating_matrix, test_rating_matrix = get_user_seqs(df)
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -   File "/opt/ml/git/final-project-level3-recsys-02/bentoml/utils.py", line 169, in get_user_seqs
[2023-02-04 18:40:54,054] {subprocess.py:89} INFO -     valid_rating_matrix = generate_rating_matrix_valid(user_seq, num_users, num_items)
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -   File "/opt/ml/git/final-project-level3-recsys-02/bentoml/utils.py", line 120, in generate_rating_matrix_valid
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -     rating_matrix = csr_matrix((data, (row, col)), shape=(num_users, num_items))
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -   File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/scipy/sparse/compressed.py", line 54, in __init__
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -     other = self.__class__(coo_matrix(arg1, shape=shape))
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -   File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/scipy/sparse/coo.py", line 196, in __init__
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -     self._check()
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -   File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/scipy/sparse/coo.py", line 285, in _check
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO -     raise ValueError('column index exceeds matrix dimensions')
[2023-02-04 18:40:54,055] {subprocess.py:89} INFO - ValueError: column index exceeds matrix dimensions
[2023-02-04 18:40:54,248] {subprocess.py:93} INFO - Command exited with return code 1
[2023-02-04 18:40:54,249] {taskinstance.py:1686} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1324, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1443, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1499, in _execute_task
    result = execute_callable(context=context)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/operators/bash.py", line 187, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-02-04 18:40:54,256] {taskinstance.py:1270} INFO - Marking task as FAILED. dag_id=Train, task_id=Train, execution_date=20230201T000000, start_date=20230204T184052, end_date=20230204T184054
[2023-02-04 18:40:54,267] {standard_task_runner.py:88} ERROR - Failed to execute job 10 for task Train
Traceback (most recent call last):
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 292, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 180, in _run_raw_task
    ti._run_raw_task(
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1324, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1443, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1499, in _execute_task
    result = execute_callable(context=context)
  File "/opt/ml/.cache/pypoetry/virtualenvs/01-bentoml-kzmRLtjI-py3.8/lib/python3.8/site-packages/airflow/operators/bash.py", line 187, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2023-02-04 18:40:54,284] {local_task_job.py:154} INFO - Task exited with return code 1
[2023-02-04 18:40:54,307] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
